<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Apm-mavlink-to-frsky : Arducopter Mavlink telemetry to FrSky Taranis" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Apm-mavlink-to-frsky</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/vizual54/APM-Mavlink-to-FrSky">View on GitHub</a>

          <h1 id="project_title">Apm-mavlink-to-frsky</h1>
          <h2 id="project_tagline">Arducopter Mavlink telemetry to FrSky Taranis</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/vizual54/APM-Mavlink-to-FrSky/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/vizual54/APM-Mavlink-to-FrSky/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2>
<a name="arducopter-mavlink-telemetry-to-frsky-taranis" class="anchor" href="#arducopter-mavlink-telemetry-to-frsky-taranis"><span class="octicon octicon-link"></span></a>Arducopter Mavlink telemetry to FrSky Taranis.</h2>

<p>This project was created to get telemetry data from the APM down to my Taranis radio. Using an Arduino Pro mini we can read Mavlink data from the APM and translate this to the FrSky hub telemetry protocol. This means that this will only work with FrSky receivers that support the old telemetry protocol, D4R-II, D8R-XP etc. A S.Port implementation for the X8R will be implemented as soon as someone hacks the protocol.</p>

<p>Download the latest hex for arduino pro mini <a href="https://github.com/vizual54/APM-Mavlink-to-FrSky/tree/master/Binaries">here</a></p>

<h2>
<a name="data-currently-sent-to-the-taranis-is" class="anchor" href="#data-currently-sent-to-the-taranis-is"><span class="octicon octicon-link"></span></a>Data currently sent to the Taranis is:</h2>

<ul>
<li>Alt:      Altitude from ARM point</li>
<li>Rpm:      Throttle out</li>
<li>Fuel:     Battery remaining</li>
<li>T1:       APM mode</li>
<li>T2:       Sat fix and count. 38 means 3d fix and 8 sats, 04 means no fix and 4 sats</li>
<li>Spd:      GPS speed over ground in knots</li>
<li>Dist:     -</li>
<li>GAlt:     GPS Altitude</li>
<li>Cell:     -</li>
<li>Cels:     Battery voltage</li>
<li>Vfas:     -</li>
<li>Curr:     Battery current</li>
<li>Cnsp:     mAh used totalizer (calculated value in the Taranis)<br>
</li>
<li>Powr:     Power (calculated value in the Taranis)</li>
<li>AccX:     Attitude pitch</li>
<li>AccY:     Attitude roll</li>
<li>AccZ:     Attitude yaw</li>
<li>Hdg:      Heading</li>
</ul><h2>
<a name="how-to-connect" class="anchor" href="#how-to-connect"><span class="octicon octicon-link"></span></a>How to connect</h2>

<p>There are two ways to connect your arduino pro mini to the APM. Either by enabling the UART2 port on the APM or by sharing the TX line with the 3DR radio.</p>

<h3>
<a name="using-uart2-port" class="anchor" href="#using-uart2-port"><span class="octicon octicon-link"></span></a>Using UART2 port</h3>

<p>This way you dont have to connect with the 3dr radio to get the mavlink data going. The Arduino will make a mavlink rate request to the APM.
This is done by modifying system.pde around line 149 to look like this(AC 3.1RC7).</p>

<p>//#if CONFIG_HAL_BOARD != HAL_BOARD_APM2
// we have a 2nd serial port for telemetry on all boards except
// APM2. We actually do have one on APM2 but it isn't necessary as
// a MUX is used
hal.uartC-&gt;begin(map_baudrate(g.serial3_baud, SERIAL3_BAUD), 128, 128);
gcs3.init(hal.uartC);
//#endif</p>

<p>A precompiled 3.1rc7 for quads can be found <a href="https://github.com/vizual54/APM-Mavlink-to-FrSky/tree/master/Binaries">here</a></p>

<p><img src="https://github.com/vizual54/APM-Mavlink-to-FrSky/blob/master/APM_UART2_to_D4R.jpg?raw=true" alt="APM UART2 to Arduino pro mini"></p>

<h3>
<a name="sharing-uart0-with-3dr-radio" class="anchor" href="#sharing-uart0-with-3dr-radio"><span class="octicon octicon-link"></span></a>Sharing UART0 with 3DR radio</h3>

<p>This way you always have to connect with the 3dr radio to get data to the Taranis but you dont have to modify the code and build arducopter yourself.
Here is one way to connect the arduino to the uart0 port to share the TX line with the 3dr radio. you can also split the TX line from the telemetry port of the APM.
<img src="https://github.com/vizual54/APM-Mavlink-to-FrSky/blob/master/APM_UART0_to_D4R.jpg?raw=true" alt="APM UART0 to Arduino pro mini"></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Apm-mavlink-to-frsky maintained by <a href="https://github.com/vizual54">vizual54</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
